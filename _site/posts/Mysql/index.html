<!DOCTYPE html><html lang="en"> <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="google-site-verification" content="_fo0YQ3t-OohNenL4cLFX9_sGdqzNIbviBLtJUDDvBs" /><title>Docker-compose를 이용한 MySQL 구축 |프리즈의 귀차니즘</title><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Docker-compose를 이용한 MySQL 구축" /><meta name="author" content="Freez" /><meta property="og:locale" content="ko" /><meta name="description" content="개요" /><meta property="og:description" content="개요" /><link rel="canonical" href="https://freez2385.github.io/posts/Mysql/" /><meta property="og:url" content="https://freez2385.github.io/posts/Mysql/" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-11-22T21:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Docker-compose를 이용한 MySQL 구축" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Freez" /><meta name="google-site-verification" content="_fo0YQ3t-OohNenL4cLFX9_sGdqzNIbviBLtJUDDvBs" /> <script type="application/ld+json"> {"headline":"Docker-compose를 이용한 MySQL 구축","dateModified":"2022-11-22T21:23:56+09:00","datePublished":"2022-11-22T21:00:00+09:00","url":"https://freez2385.github.io/posts/Mysql/","mainEntityOfPage":{"@type":"WebPage","@id":"https://freez2385.github.io/posts/Mysql/"},"@type":"BlogPosting","description":"개요","author":{"@type":"Person","name":"Freez"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-40Q1H33Y1E"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-40Q1H33Y1E'); </script><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/main.css"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script data-ad-client="ca-pub-6084725314079241" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous" async></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="style" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/syntax.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/syntax.css"> <script src="/assets/js/dist/jquery.magnific-popup.min.js"></script> <script src="/assets/js/dist/magnific-popup-setting.js"></script><link rel="stylesheet" href="/assets/css/magnific-popup.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">프리즈의 귀차니즘</a></div><div id="site-subtitle">일본에 거주하는 개발자의 기술 블로그</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>홈</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>카테고리</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>태그</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>포스트 이력</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>포트폴리오</span> </a></li></ul></div><div class="contact d-flex justify-content-around mt-4"> <a href="https://github.com/FREEZ2385" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="javascript:window.open('mailto:' + ['schlee9703','gmail.com'].join('@'))"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" target="_blank"> <i class="fas fa-rss"></i> </a></div><div class="language d-flex justify-content-center"> <a class="language-dropdown"> <i class="fa fa-language"></i> <span>Language</span> </a></div><div class="language d-flex justify-content-around"> <a href="https://freez2385.github.io/">Korean</a> <a href="https://freez2385.github.io/ja/">Japanese</a></div></div><div id="main-wrapper"> <!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Docker-compose를 이용한 MySQL 구축</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <a href="javascript:;">Cancel</a></div></div><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"> <!-- Define the liquid date formats. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Docker-compose를 이용한 MySQL 구축</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago" data-toggle="tooltip" title="Tue, Nov 22, 2022, 9:00 PM +0900"> Nov 22, 2022 <i class="unloaded">2022-11-22T21:00:00+09:00</i> </span> on <a href='/categories/development/'>Development</a>, <a href='/categories/docker/'>Docker</a></div><div> Updated <span class="timeago lastmod" data-toggle="tooltip" title="Tue, Nov 22, 2022, 9:23 PM +0900"> Nov 22, 2022 <i class="unloaded">2022-11-22T21:23:56+09:00</i> </span></div></div><div class="post-content"><h2 id="개요">개요</h2><p>필자가 Spring Boot를 익히는 동안 데이터베이스의 연계도 필요하다 생각했기에, Spring에 DB접속하기 쉬운 MySQL를 구축할 예정을 잡았다. 원래대로라면 로컬에 MySQL를 넣으면 간단하게 될 일이였지만 나중에 로컬에서 MySQL를 삭제하기 귀찮을 뿐더러, MySQL를 관리할 수 있는 툴로 phpMyAdmin을 같이 구축하는 방향으로 생각을 하게 되었다. 필요할때 구축하고 바로 삭제 가능한 방향으로 하는 방법으로는 역시 가상환경 or 컨테이너를 이용하는 것이 제일 좋을 듯 싶다. 하지만 가상환경은 용량과 구축의 귀찮음을 느껴 Docker 컨테이너로 빌드해 언제든지 실행/중단이 가능하며 삭제도 쉽게 가능한 환경을 만들어보는 작업을 해보았다. 이전 포스팅한 Docker-compose를 통해 컨테이너와 이미지를 쉽게 지정하고 구축하는 방법을 시도했다.</p><p><a href="https://freez2385.github.io/posts/Docker-compose/">Docker-compose의 운용과 작성방식</a></p><p>MySQL과 phpMyAdmin 이미지를 가져와 한번에 컨테이너 안에 가져와 운영하는 방식으로 진행해보도록 하겠다. 추가로 초기 데이터베이스 작성 후 간단한 테이블 작성도 같이 해보도록 하겠다.</p><hr /><h2 id="docker-composeyml-작성">Docker-compose.yml 작성</h2><p>이전 포스트와 같이 docker-compose.yml을 먼저 작성하도록 하겠다. 이번에는 MySQL과 동시에, phpMyAdmin도 같이 가져와 데이터베이스 관리까지 같은 컨테이너 안에서 실행해보도록 하겠다.</p><p><code class="language-plaintext highlighter-rouge">docker-compose.yml</code></p><div class="language-yml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3'</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="c1"># MySQL</span>
  <span class="na">db</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">mysql:5.7</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">mysql_host</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">MYSQL_ROOT_PASSWORD</span><span class="pi">:</span> <span class="s">root</span> <span class="c1"># 루트 진입시 필요한 패스워드</span>
      <span class="na">MYSQL_DATABASE</span><span class="pi">:</span> <span class="s">test_db</span> <span class="c1"># 데이터베이스 생성시 데이터베이스명</span>
      <span class="na">MYSQL_USER</span><span class="pi">:</span> <span class="s">admin</span> <span class="c1"># 관리자 유저 ID</span>
      <span class="na">MYSQL_PASSWORD</span><span class="pi">:</span> <span class="s">admin</span> <span class="c1"># 관리자 유저 PW</span>
      <span class="na">TZ</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Asia/Tokyo'</span>
    <span class="na">command</span><span class="pi">:</span> <span class="s">mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci</span> <span class="c1"># 빌드 후 데이터베이스 문자열을 UTF-8로 변경</span>
    <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">./docker/db/data:/var/lib/mysql</span> <span class="c1"># 데이터 베이스 저장소(container 재실행시 이전 정보 유지)</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">3306:3306</span>

  <span class="c1"># phpMyAdmin</span>
  <span class="na">phpmyadmin</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">test_phpmyadmin</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">phpmyadmin/phpmyadmin</span>
    <span class="na">environment</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">PMA_ARBITRARY=1</span>
    <span class="pi">-</span> <span class="s">PMA_HOSTS=mysql_host</span>
    <span class="pi">-</span> <span class="s">PMA_USER=root</span>
    <span class="pi">-</span> <span class="s">PMA_PASSWORD=root</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">5050:80</span>
</pre></table></code></div></div><p>위와 같이 코드를 작성하였다. MySQL포트는 똑같이 <code class="language-plaintext highlighter-rouge">3306</code>으로 지정하였고, phpMyAdmin은 임의로 <code class="language-plaintext highlighter-rouge">5050</code>으로 지정하였다.</p><p>그리고 <code class="language-plaintext highlighter-rouge">volumes</code>안의 폴더는 임의로 docker/db/data의 식으로 넣어놓았다. 그렇기 때문에 현재 파일 트리는</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>./
├── docker
│   └── db
│       └── data
└── docker-compose.yml
</pre></table></code></div></div><p>이렇게 설정해야 빌드가 가능하다. 이제 파일 구성을 마치고 바로 데이터베이스 구축이 가능하다. 이하의 명령어를 입력해주도록 하자. (Docker-compose.yml가 있는 디렉토리 내에서)</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker-compose up -d
</pre></table></code></div></div><p>이렇게만 해도 바로 MySQL과 phpMyAdmin 구축이 성공이 되었다. 확인 방법은 phpMyAdmin이 접속되었나로 확인이 가능하다. 필자는 <code class="language-plaintext highlighter-rouge">http://localhost:5050</code>으로 접속하여 아래와 같은 화면이 접속 되었다.</p><p><img src="https://s3.ap-northeast-1.amazonaws.com/freez2385.blog/img/2022-11-22-mysql/mysql1.png" alt="mysql1" /></p><p>이렇게 구축이 되었다면 data폴더에도 mySQL에 필요한 파일들이 생성되어 있을 것이다. 이것들은 잠시 뒤로 하고, 여기서 추가적으로 초기 데이터베이스 작성과 테이블 작성을 해보겠다.</p><blockquote><p>필자는 MacOS를 사용하고 있기 때문에 Linux환경을 바탕으로 작성하였다. Windows를 이용하시는 분들은 init-mysql.sh 내용을 하나하나 입력하면 테이블 작성이 가능하다.</p></blockquote><hr /><h2 id="sh파일을-이용한-초기-테이블-작성linux환경">sh파일을 이용한 초기 테이블 작성(Linux환경)</h2><p>필자는 docker폴더 내에 초기 테이블 작성 환경을 만들기 위한 sql폴더를 생성하였다. sql폴더를 작성 후 필요한 sql파일을 작성해보았다. 내용은 간단한 테이블 작성 내용이다.</p><p><code class="language-plaintext highlighter-rouge">01-create-tables.sql</code></p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c1">---- drop ----</span>
<span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="nv">`test_table`</span><span class="p">;</span>

<span class="c1">---- create ----</span>
<span class="k">create</span> <span class="k">table</span> <span class="n">IF</span> <span class="k">not</span> <span class="k">exists</span> <span class="nv">`test_table`</span>
<span class="p">(</span>
 <span class="nv">`id`</span>               <span class="nb">INT</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
 <span class="nv">`name`</span>             <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
 <span class="nv">`created_at`</span>       <span class="nb">Datetime</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
 <span class="nv">`updated_at`</span>       <span class="nb">Datetime</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">)</span>
<span class="p">)</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span> <span class="k">COLLATE</span><span class="o">=</span><span class="n">utf8_bin</span><span class="p">;</span>

</pre></table></code></div></div><p>sql파일을 생성 후에는 후에 sh파일을 생성하였다. sql폴더 자체를 docker-compose의 volume으로 넣어 컨테이너 내부로 파일을 공유한 후 그 안에서 sh파일을 사용하기 위해서이다. sh파일은 다음과 같다.</p><p><code class="language-plaintext highlighter-rouge">init-database.sh</code></p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c">#!/usr/bin/env bash</span>
<span class="c">#wait for the MySQL Server to come up</span>
<span class="c">#sleep 90s</span>

<span class="c">#run the setup script to create the DB and the schema in the DB</span>
mysql <span class="nt">-u</span> <span class="nv">$MYSQL_USER</span> <span class="nt">-p</span><span class="nv">$MYSQL_PASSWORD</span> test_db &lt; <span class="s2">"/docker-entrypoint-initdb.d/001-create-tables.sql"</span>
</pre></table></code></div></div><p>이렇게 sh파일을 동시에 생성한 후 docker-compose.yml의 volumes에 다음과 같이 추가한다.</p><p><code class="language-plaintext highlighter-rouge">docker-compose.yml</code></p><div class="language-yml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3'</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="c1"># MySQL</span>
  <span class="na">db</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">mysql:5.7</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">mysql_host</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">MYSQL_ROOT_PASSWORD</span><span class="pi">:</span> <span class="s">root</span>
      <span class="na">MYSQL_DATABASE</span><span class="pi">:</span> <span class="s">test_db</span>
      <span class="na">MYSQL_USER</span><span class="pi">:</span> <span class="s">admin</span>
      <span class="na">MYSQL_PASSWORD</span><span class="pi">:</span> <span class="s">admin</span>
      <span class="na">TZ</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Asia/Tokyo'</span>
    <span class="na">command</span><span class="pi">:</span> <span class="s">mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci</span> 
    <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">./docker/db/data:/var/lib/mysql</span>
    <span class="pi">-</span> <span class="s">./docker/db/sql:/docker-entrypoint-initdb.d</span> <span class="c1"># 새로 추가된 volume</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">3306:3306</span>

  <span class="c1"># phpMyAdmin</span>
  <span class="na">phpmyadmin</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">test_phpmyadmin</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">phpmyadmin/phpmyadmin</span>
    <span class="na">environment</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">PMA_ARBITRARY=1</span>
    <span class="pi">-</span> <span class="s">PMA_HOSTS=mysql_host</span>
    <span class="pi">-</span> <span class="s">PMA_USER=root</span>
    <span class="pi">-</span> <span class="s">PMA_PASSWORD=root</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">5050:80</span>
</pre></table></code></div></div><p>이렇게 추가하게 되면 sql폴더 내부에 있는 파일들은 컨테이너 안의 볼륨에 포함되었다. 현재의 파일 트리는 다음과 같다.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>.
├── docker
│   └── db
│       ├── data
│       └── sql
│           ├── 001-create-tables.sql
│           └── init-database.sh
└── docker-compose.yml

</pre></table></code></div></div><p>이제 내부에 sh를 작동시킬 sh파일을 외부에 생성하여 직접 컨테이너에 들어가지 않으면서도 테이블을 작성을 해보겠다. Docker-compose.yml에 위치한 폴더에 sh파일을 하나 만들도록 하겠다.</p><p><code class="language-plaintext highlighter-rouge">init-mysql.sh</code></p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c">#!/bin/sh</span>
docker-compose <span class="nb">exec </span>db bash <span class="nt">-c</span> <span class="s2">"chmod 0775 docker-entrypoint-initdb.d/init-database.sh"</span>
docker-compose <span class="nb">exec </span>db bash <span class="nt">-c</span> <span class="s2">"./docker-entrypoint-initdb.d/init-database.sh"</span>
</pre></table></code></div></div><p>여기서 windows를 사용하는 분들은 해당 명령어를 직접 치기만 하면 된다. 혹여나 귀찮다면 batch 파일로 작성해도 괜찮다.</p><p>이렇게 작성한 후 해당 명령어를 입력하면 자동으로 테이블 작성이 가능하다.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sh init-mysql.sh
</pre></table></code></div></div><p>그러면 phpMyAdmin에서 테이블이 하나 추가된 것을 볼 수 있다.</p><p><img src="https://s3.ap-northeast-1.amazonaws.com/freez2385.blog/img/2022-11-22-mysql/mysql2.png" alt="mysql2" /></p><hr /><p>이렇게 Docker 컨테이너를 이용한 MySQL 구축이 완료되었다. 기존 로컬에서 설치 후 서버를 On/Off하는 것보다는 깔끔하게 컨테이너에서 phpMyAdmin과 같이 만드는게 편하다고 생각하여 만들어본 구성이다. 불명확한 점 혹은 궁금한 점이 있다면 댓글로 남겨주시기 바란다.</p></div><div class="post-tail text-muted"><div class="mb-4"> <a href="/tags/mysql/" class="post-tag no-text-decoration" >Mysql</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >Docker</a></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 topbar-down"><div class="access"><div id="access-lastmod" class="post mb-4"><h3 data-toc-skip>최근 포스트</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Mysql/">Docker-compose를 이용한 MySQL 구축</a></li><li><a href="/posts/Spring-Boot/">VSCode를 사용하여 Spring Boot API 작성</a></li><li><a href="/posts/React-Redux/">React Redux의 원리</a></li><li><a href="/posts/React-Redux2/">React Redux를 사용해보자(Redux Hooks 추가 및 devtools 사용)</a></li><li><a href="/posts/React-Testing-Library/">React Testing Library 컴포넌트 테스트 사용법</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>태그</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/react/">React</a> <a class="post-tag" href="/tags/component/">Component</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/virtual/">Virtual</a> <a class="post-tag" href="/tags/image/">Image</a> <a class="post-tag" href="/tags/container/">Container</a> <a class="post-tag" href="/tags/redux/">Redux</a> <a class="post-tag" href="/tags/github/">Github</a> <a class="post-tag" href="/tags/djangorestframework/">DjangoRestframework</a> <a class="post-tag" href="/tags/django/">Django</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2">목차</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Docker/"><div class="card-body"> <span class="timeago small"> Sep 28, 2020 <i class="unloaded">2020-09-28T22:25:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Docker의 기본</h3><div class="text-muted small"><p>필자는 웹 어플리케이션 개발을 하던 시절에 인프라나 백엔드에 대해서 많이 몰랐던 시기이고 이것저것 공부를 하던 도중에 Docker를 알게 되면서 이것 저것 공부한 내용을 여기에 적어보기로 하겠다. 대체로 서버에 주로 사용하는 콘테이너형 가상 플랫폼으로 Docker를 주로 애용하고 있다. 필자도 서버의 일부중 Docker 컨테이너를 직접 빌드해 사용해본...</p></div></div></a></div><div class="card"> <a href="/posts/Dockerfile/"><div class="card-body"> <span class="timeago small"> Oct 2, 2020 <i class="unloaded">2020-10-02T20:40:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dockerfile 작성 및 빌드를 해보자</h3><div class="text-muted small"><p>본 포스트는 MacOS 10.15.7 을 기준으로 작성하였습니다. 필자는 프로젝트를 개발하면서 서버 인프라에 Docker를 사용하고 있다. 그러면서 Docker에 이미지를 생성해 직접 빌드하는 경우도 종종 볼 수 있었다. 이번에는 직접 Docker에 이미지 생성을 하는 Dockerfile 이라는 개념에 대해 설명하도록 하겠다. 이전 포스팅에서 이미지...</p></div></div></a></div><div class="card"> <a href="/posts/Docker-compose/"><div class="card-body"> <span class="timeago small"> Oct 6, 2020 <i class="unloaded">2020-10-06T22:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Docker-compose의 운용과 작성방식</h3><div class="text-muted small"><p>본 포스트는 MacOS 10.15.7 을 기준으로 작성하였습니다. 저번 포스팅에서 Dockerfile을 이용하여 컨테이너를 통해서 이미지를 빌드시키는 방법을 설명했었다. 이번에는 이러한 컨테이너들을 다중으로 존재할 때 쉽게 제어가 가능한 Docker-compose 에 대해서 알아보도록 하겠다. Docker-compose 는 Docker를 이용하기 위...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Spring-Boot/" class="btn btn-outline-primary"><p>VSCode를 사용하여 Spring Boot API 작성</p></a> <a href="/posts/diary_20250205/" class="btn btn-outline-primary"><p>어플리케이션 아키텍쳐에 대한 생각</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const observer = lozad(); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="copyright"><p class="mb-0"> © 2019-2025<a href="https://github.com/FREEZ2385" class="ml-1">Lee SangCheol</a>. <br>Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a>, theme by <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a>.</p></div><div class="license"><p class="mb-0"> The blog posts on this site are licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted">태그</h4><!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/react/">React</a> <a class="post-tag" href="/tags/component/">Component</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/virtual/">Virtual</a> <a class="post-tag" href="/tags/image/">Image</a> <a class="post-tag" href="/tags/container/">Container</a> <a class="post-tag" href="/tags/redux/">Redux</a> <a class="post-tag" href="/tags/github/">Github</a> <a class="post-tag" href="/tags/djangorestframework/">DjangoRestframework</a> <a class="post-tag" href="/tags/django/">Django</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://freez2385.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
